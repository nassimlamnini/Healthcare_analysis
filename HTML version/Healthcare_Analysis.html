<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>dd51438cbbc74b84b67f619b8c763beb</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="healthcare-data-analysis-project" class="cell markdown">
<h1><strong>Healthcare Data Analysis Project</strong></h1>
<h2 id="introduction">Introduction</h2>
<p>This project aims to explore and analyze a synthetic healthcare
dataset. The dataset, designed for educational and research purposes,
mimics real-world health data and offers a rich ground for practicing
data manipulation, analysis, and predictive modeling in the
healthcare.</p>
<h2 id="project-objectives">Project Objectives</h2>
<ul>
<li><strong>Data Cleaning and Preprocessing:</strong> Address data
quality issues and prepare the dataset for analysis.</li>
<li><strong>Exploratory Data Analysis:</strong> Gain insights into the
data by exploring distributions, patterns, and relationships.</li>
<li><strong>Predictive Modeling:</strong> Develop a model to predict
patient outcomes or other relevant predictions based on the
dataset.</li>
</ul>
</section>
<section id="1-data-cleaning-and-preprocessing" class="cell markdown">
<h1>1. Data Cleaning and Preprocessing:</h1>
</section>
<div class="cell markdown">
<ul>
<li>Importing Libraries</li>
</ul>
</div>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div>
</div>
<div class="cell markdown">
<ul>
<li>Data Loading</li>
</ul>
</div>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">&quot;healthcare_dataset_bruit√©.csv&quot;</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<ul>
<li>Initial Data Exploration</li>
</ul>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First rows</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Gender</th>
      <th>Blood Type</th>
      <th>Medical Condition</th>
      <th>Date of Admission</th>
      <th>Doctor</th>
      <th>Hospital</th>
      <th>Insurance Provider</th>
      <th>Billing Amount</th>
      <th>Room Number</th>
      <th>Admission Type</th>
      <th>Discharge Date</th>
      <th>Medication</th>
      <th>Test Results</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tiffany Ramirez</td>
      <td>81.0</td>
      <td>Female</td>
      <td>O-</td>
      <td>Diabetes</td>
      <td>2022-11-17</td>
      <td>Patrick Parker</td>
      <td>Wallace-Hamilton</td>
      <td>Medicare</td>
      <td>37490.983364</td>
      <td>NaN</td>
      <td>Elective</td>
      <td>2022-12-01</td>
      <td>Aspirin</td>
      <td>Inconclusive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ruben Burns,35,Male,O+,Asthma,2023-06-01,Diane...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Chad Byrd</td>
      <td>61.0</td>
      <td>Male</td>
      <td>B-</td>
      <td>Obesity</td>
      <td>2019-01-09</td>
      <td>Paul Baker</td>
      <td>Walton LLC</td>
      <td>Medicare</td>
      <td>36874.896997</td>
      <td>292.0</td>
      <td>Emergency</td>
      <td>2019-02-08</td>
      <td>Lipitor</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Antonio Frederick</td>
      <td>49.0</td>
      <td>Male</td>
      <td>B-</td>
      <td>Asthma</td>
      <td>2020-05-02</td>
      <td>Brian Chandler</td>
      <td>Garcia Ltd</td>
      <td>Medicare</td>
      <td>23303.322092</td>
      <td>480.0</td>
      <td>Urgent</td>
      <td>2020-05-03</td>
      <td>Penicillin</td>
      <td>Abnormal</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mrs. Brandy Flowers,51,Male,O-,Arthritis,2021-...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Basic information</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10000 entries, 0 to 9999
Data columns (total 15 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   Name                10000 non-null  object 
 1   Age                 6707 non-null   float64
 2   Gender              6707 non-null   object 
 3   Blood Type          6707 non-null   object 
 4   Medical Condition   6707 non-null   object 
 5   Date of Admission   6707 non-null   object 
 6   Doctor              6707 non-null   object 
 7   Hospital            6707 non-null   object 
 8   Insurance Provider  6707 non-null   object 
 9   Billing Amount      6707 non-null   float64
 10  Room Number         6704 non-null   float64
 11  Admission Type      6707 non-null   object 
 12  Discharge Date      6707 non-null   object 
 13  Medication          6707 non-null   object 
 14  Test Results        6707 non-null   object 
dtypes: float64(3), object(12)
memory usage: 1.1+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Descriptive statistics</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Billing Amount</th>
      <th>Room Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6707.000000</td>
      <td>6707.000000</td>
      <td>6704.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>51.313702</td>
      <td>25521.369023</td>
      <td>300.208234</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.593787</td>
      <td>14054.260120</td>
      <td>116.141056</td>
    </tr>
    <tr>
      <th>min</th>
      <td>18.000000</td>
      <td>1000.180837</td>
      <td>101.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>35.000000</td>
      <td>13660.212091</td>
      <td>199.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>52.000000</td>
      <td>25268.536976</td>
      <td>299.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>68.000000</td>
      <td>37724.630016</td>
      <td>401.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>85.000000</td>
      <td>49995.902283</td>
      <td>500.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Count of Unique Values in Each Column</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df.nunique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<pre><code>Name                  9696
Age                     68
Gender                   2
Blood Type               8
Medical Condition        6
Date of Admission     1772
Doctor                6438
Hospital              5346
Insurance Provider       5
Billing Amount        6707
Room Number            400
Admission Type           3
Discharge Date        1792
Medication               5
Test Results             3
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li>Data Cleaning</li>
</ul>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>Room Number           3296
Age                   3293
Gender                3293
Blood Type            3293
Medical Condition     3293
Date of Admission     3293
Doctor                3293
Hospital              3293
Insurance Provider    3293
Billing Amount        3293
Admission Type        3293
Discharge Date        3293
Medication            3293
Test Results          3293
Name                     0
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>Since there are a lot of NaN values as seen here, they need to be
dropped.</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.dropna(subset<span class="op">=</span>[<span class="st">&#39;Test Results&#39;</span>])</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre><code>Room Number           3
Name                  0
Age                   0
Gender                0
Blood Type            0
Medical Condition     0
Date of Admission     0
Doctor                0
Hospital              0
Insurance Provider    0
Billing Amount        0
Admission Type        0
Discharge Date        0
Medication            0
Test Results          0
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>All NaN values been dropped, except for the room
numbers.</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>most_frequent_room <span class="op">=</span> df[<span class="st">&#39;Room Number&#39;</span>].mode()[<span class="dv">0</span>]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;Room Number&#39;</span>].isnull(), <span class="st">&#39;Room Number&#39;</span>] <span class="op">=</span> most_frequent_room</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Room Number&#39;</span>].isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>Instead of replacing 'Room Number' missed values by its average,
we have chosen to replace it by the most frequent room number since its
data type is an "int".</em></p>
</blockquote>
</div>
<div class="cell markdown">
<blockquote>
<p><em>Now we'll be looking for aberrant values.</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Billing Amount</th>
      <th>Room Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6707.000000</td>
      <td>6707.000000</td>
      <td>6707.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>51.313702</td>
      <td>25521.369023</td>
      <td>300.188907</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.593787</td>
      <td>14054.260120</td>
      <td>116.118670</td>
    </tr>
    <tr>
      <th>min</th>
      <td>18.000000</td>
      <td>1000.180837</td>
      <td>101.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>35.000000</td>
      <td>13660.212091</td>
      <td>199.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>52.000000</td>
      <td>25268.536976</td>
      <td>299.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>68.000000</td>
      <td>37724.630016</td>
      <td>401.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>85.000000</td>
      <td>49995.902283</td>
      <td>500.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>Right off the bat, we see that there are no aberrant values in
both max and min which is good.</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df.describe(include<span class="op">=</span><span class="st">&quot;O&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Gender</th>
      <th>Blood Type</th>
      <th>Medical Condition</th>
      <th>Date of Admission</th>
      <th>Doctor</th>
      <th>Hospital</th>
      <th>Insurance Provider</th>
      <th>Admission Type</th>
      <th>Discharge Date</th>
      <th>Medication</th>
      <th>Test Results</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
      <td>6707</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>6403</td>
      <td>2</td>
      <td>8</td>
      <td>6</td>
      <td>1772</td>
      <td>6438</td>
      <td>5346</td>
      <td>5</td>
      <td>3</td>
      <td>1792</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Michael Johnson</td>
      <td>Female</td>
      <td>AB+</td>
      <td>Hypertension</td>
      <td>2022-10-01</td>
      <td>Michael Johnson</td>
      <td>Smith PLC</td>
      <td>Aetna</td>
      <td>Urgent</td>
      <td>2020-08-08</td>
      <td>Penicillin</td>
      <td>Abnormal</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>6</td>
      <td>3435</td>
      <td>864</td>
      <td>1151</td>
      <td>13</td>
      <td>6</td>
      <td>19</td>
      <td>1382</td>
      <td>2285</td>
      <td>11</td>
      <td>1405</td>
      <td>2280</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>We are going to verify now the values type "object",in particular
the ligne "unique" so that we can make sure that there are no more
unique values than necessary. we see it's no the case</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df.nunique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>Name                  6403
Age                     68
Gender                   2
Blood Type               8
Medical Condition        6
Date of Admission     1772
Doctor                6438
Hospital              5346
Insurance Provider       5
Billing Amount        6707
Room Number            400
Admission Type           3
Discharge Date        1792
Medication               5
Test Results             3
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<pre><code>Name                  0
Age                   0
Gender                0
Blood Type            0
Medical Condition     0
Date of Admission     0
Doctor                0
Hospital              0
Insurance Provider    0
Billing Amount        0
Room Number           0
Admission Type        0
Discharge Date        0
Medication            0
Test Results          0
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>As shown, the data has been cleaned.</em></p>
</blockquote>
</div>
<div class="cell markdown">
<ul>
<li>Key points after cleaning the data:
<ul>
<li>Patients ranging in <strong>Age</strong> from 18 to 85 years
resulting in 51 years in average</li>
<li>The <strong>Billing Amount</strong> varies significantly, with a
minimum of approximately $1,000 and a maximum near $50,000.</li>
<li><strong>Room Number</strong> shows a wide range, from 101 to 500 and
the average room number is around 300</li>
</ul></li>
</ul>
</div>
<section id="2-exploratory-data-analysis" class="cell markdown">
<h1>2. Exploratory Data Analysis:</h1>
</section>
<div class="cell markdown">
<ul>
<li>Correlation Analysis:</li>
</ul>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df[[<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Billing Amount&#39;</span>, <span class="st">&#39;Room Number&#39;</span>]].corr()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Correlation Matrix&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59caa8df667b480a9ba61a4e558f3551/b500c23a831948282db4ce0389251522f29b9cd5.png" /></p>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>The low correlation between them indicates that there is no
significant relationship between a patient's age and their room number,
or the billing amount, or between the billing amount and the room
number</em></p>
</blockquote>
</div>
<div class="cell markdown">
<ul>
<li>Time-Series Analysis</li>
</ul>
</div>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.copy()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Date of Admission&#39;</span>] <span class="op">=</span> pd.to_datetime(df1[<span class="st">&#39;Date of Admission&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df1.dropna(subset<span class="op">=</span>[<span class="st">&#39;Date of Admission&#39;</span>])</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="op">=</span> df1.set_index(<span class="st">&#39;Date of Admission&#39;</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>monthly_admissions <span class="op">=</span> time_series_data.resample(<span class="st">&#39;M&#39;</span>).size()</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting the trends in admissions over time</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">4</span>))</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>monthly_admissions.plot(title<span class="op">=</span><span class="st">&#39;Monthly Admissions Over Time&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date of Admission&#39;</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Admissions&#39;</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59caa8df667b480a9ba61a4e558f3551/b315d6970cac917ae0b16d8f725a7334e2ca6e5b.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>‚òÖ Observations:</p>
<ul>
<li>There appear to be fluctuations in the number of admissions per
month.</li>
<li>Certain periods show peaks, which could indicate higher admission
rates during those times.</li>
</ul>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>monthly_billing_avg <span class="op">=</span> time_series_data[<span class="st">&#39;Billing Amount&#39;</span>].resample(<span class="st">&#39;M&#39;</span>).mean()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the trends in average billing amounts over time</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">4</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>monthly_billing_avg.plot(title<span class="op">=</span><span class="st">&#39;Monthly Average Billing Amount Over Time&#39;</span>, color<span class="op">=</span><span class="st">&#39;green&#39;</span>, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Billing Amount&#39;</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59caa8df667b480a9ba61a4e558f3551/d28701cfbc56071e4f54578fb9b344c9b23a693b.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>‚òÖ Observations:</p>
<ul>
<li>The graph shows variations in the average billing amount per
month.</li>
<li>There are noticeable fluctuations, indicating changes in the average
cost of treatment over different months.</li>
</ul>
</div>
<div class="cell markdown">
<blockquote>
<p><em>This analysis can be valuable for identifying periods of higher
or lower healthcare costs. Such trends might be influenced by various
factors (new treatments, different policies, ... ).</em></p>
</blockquote>
</div>
<div class="cell markdown">
<ul>
<li>Histogram for 'Age'</li>
</ul>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&#39;Age&#39;</span>, bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Age Distribution&#39;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Age&#39;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59caa8df667b480a9ba61a4e558f3551/a7a3457262248479d7f0e658a780aea6309dab85.png" /></p>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>The presence of multiple peaks may imply that certain age groups
are more prevalent in the dataset, which could be reflective of specific
age-related health trends or demographic patterns in the population
studied.</em></p>
</blockquote>
</div>
<div class="cell markdown">
<ul>
<li>Box Plot for 'Billing Amount'</li>
</ul>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&#39;Billing Amount&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Billing Amount Distribution&#39;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Billing Amount&#39;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59caa8df667b480a9ba61a4e558f3551/b8089638049fdb99ed0f271e0e7a9b381ed5c02f.png" /></p>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>The bulk of billing amounts are concentrated in a relatively
narrow range, with a median near the center of the box, indicating a
symmetrical distribution. This indicates that there is a standardized
billing practices or consistent cost across different services or
treatments in the dataset.</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>diagnosis_counts <span class="op">=</span> df[<span class="st">&#39;Medical Condition&#39;</span>].value_counts()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>diagnosis_counts.index, y<span class="op">=</span>diagnosis_counts.values)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Frequency of Each Diagnosis&#39;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Diagnosis&#39;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59caa8df667b480a9ba61a4e558f3551/deddeff6d3cfe81d3b520f843d3e6f85d3c81b52.png" /></p>
</div>
</div>
<div class="cell markdown">
<blockquote>
<p><em>This graph shows that <strong>hypertension</strong>,
<strong>Cancer</strong> and <strong>Arthritis</strong> are the most
frequent medical conditions treated.</em></p>
</blockquote>
</div>
<section id="3-predictive-modeling" class="cell markdown">
<h1>3. Predictive Modeling:</h1>
</section>
<div class="cell markdown">
<blockquote>
<p><em>The main goal of this part is to predict the outcome of patients
(<strong>medical condition</strong>) based on different
variables</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, OneHotEncoder</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df_clean <span class="op">=</span> df.copy()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_modeling <span class="op">=</span> df_clean.dropna(subset<span class="op">=</span>[<span class="st">&#39;Test Results&#39;</span>])</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_modeling.drop([<span class="st">&#39;Test Results&#39;</span>, <span class="st">&#39;Name&#39;</span>, <span class="st">&#39;Date of Admission&#39;</span>, <span class="st">&#39;Doctor&#39;</span>, <span class="st">&#39;Hospital&#39;</span>, <span class="st">&#39;Discharge Date&#39;</span>, <span class="st">&#39;Room Number&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_modeling[<span class="st">&#39;Test Results&#39;</span>]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into training and testing sets</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining numerical and categorical columns</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> X_train.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).columns</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> X_train.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>, <span class="st">&#39;bool&#39;</span>, <span class="st">&#39;category&#39;</span>]).columns</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating preprocessing pipelines for both numerical and categorical data</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>numerical_transformer <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;imputer&#39;</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">&#39;mean&#39;</span>)),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;scaler&#39;</span>, StandardScaler())])</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>categorical_transformer <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;imputer&#39;</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">&#39;constant&#39;</span>, fill_value<span class="op">=</span><span class="st">&#39;missing&#39;</span>)),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;onehot&#39;</span>, OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">&#39;ignore&#39;</span>))])</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining preprocessing steps</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&#39;num&#39;</span>, numerical_transformer, numerical_cols),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&#39;cat&#39;</span>, categorical_transformer, categorical_cols)])</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the prediction pipeline</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">&#39;preprocessor&#39;</span>, preprocessor),</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>                        (<span class="st">&#39;classifier&#39;</span>, RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>))])</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Training the model</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting on the test set</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluating the model</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>classification_rep <span class="op">=</span> classification_report(y_test, y_pred)</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(accuracy)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.319672131147541
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_rep)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

    Abnormal       0.30      0.34      0.32       439
Inconclusive       0.36      0.30      0.33       456
      Normal       0.31      0.33      0.32       447

    accuracy                           0.32      1342
   macro avg       0.32      0.32      0.32      1342
weighted avg       0.32      0.32      0.32      1342

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;g&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted labels&#39;</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;True labels&#39;</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Confusion Matrix&#39;</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59caa8df667b480a9ba61a4e558f3551/274031baf38e22e1773c024c6e3d448c1298561a.png" /></p>
</div>
</div>
<div class="cell markdown">
<ul>
<li>Conclusion:
<ul>
<li>the model is not performing well in distinguishing between the three
classes of 'Test Results'. The accuracy is <strong>low</strong>, and the
precision and recall are <strong>not high enough</strong> to consider
the model reliable. This could be due to various reasons, such as
<strong>class imbalance, insufficient or non-informative features, or a
need for hyperparameter tuning.</strong></li>
</ul></li>
</ul>
</div>
<div class="cell markdown">
<blockquote>
<p><em>Now let's enhance the mode, hopefully for better results</em></p>
</blockquote>
</div>
<div class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingClassifier</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, accuracy_score, classification_report</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize LabelEncoder</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>label_encoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Gender&#39;</span>, <span class="st">&#39;Blood Type&#39;</span>, <span class="st">&#39;Medical Condition&#39;</span>, </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Doctor&#39;</span>, <span class="st">&#39;Hospital&#39;</span>, <span class="st">&#39;Insurance Provider&#39;</span>, </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Admission Type&#39;</span>, <span class="st">&#39;Medication&#39;</span>, <span class="st">&#39;Test Results&#39;</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>actual_categorical_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> categorical_columns <span class="cf">if</span> col <span class="kw">in</span> X_train.columns]</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode each categorical column in the training set</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> actual_categorical_columns:</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    X_train[col] <span class="op">=</span> label_encoder.fit_transform(X_train[col].astype(<span class="bu">str</span>))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Addressing class imbalance with SMOTE</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode each categorical column in the training set</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> actual_categorical_columns:</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    X_train[col] <span class="op">=</span> label_encoder.fit_transform(X_train[col].astype(<span class="bu">str</span>))</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Addressing class imbalance with SMOTE</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Gradient Boosting classifier</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>gbc <span class="op">=</span> GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a grid of parameters over which to optimize the classifier</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">100</span>, <span class="dv">200</span>],</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;learning_rate&#39;</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>],</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>]</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the grid search with cross-validation</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>gbc, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">3</span>, scoring<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the grid search on the resampled data</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train_smote, y_train_smote)</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the best model from grid search</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>best_model <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> actual_categorical_columns:</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Here, we need to handle unseen labels in the test set that weren&#39;t present in the training set</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># One common approach is to set unseen labels to a common unseen label category (like &#39;-1&#39;)</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>    X_test[col] <span class="op">=</span> X_test[col].<span class="bu">map</span>(<span class="kw">lambda</span> s: <span class="st">&#39;-1&#39;</span> <span class="cf">if</span> s <span class="kw">not</span> <span class="kw">in</span> label_encoder.classes_ <span class="cf">else</span> s)</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>    label_encoder.classes_ <span class="op">=</span> np.append(label_encoder.classes_, <span class="st">&#39;-1&#39;</span>)</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    X_test[col] <span class="op">=</span> label_encoder.transform(X_test[col].astype(<span class="bu">str</span>))</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions with the best model</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>y_pred_best <span class="op">=</span> best_model.predict(X_test)</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the best model</span></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>accuracy_best <span class="op">=</span> accuracy_score(y_test, y_pred_best)</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>classification_rep_best <span class="op">=</span> classification_report(y_test, y_pred_best)</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>confusion_matrix_best <span class="op">=</span> confusion_matrix(y_test, y_pred_best)</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the evaluation results</span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Model Accuracy: &quot;</span>, accuracy_best)</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Best Model Classification Report: </span><span class="ch">\n</span><span class="st">&quot;</span>, classification_rep_best)</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Best Model Confusion Matrix: </span><span class="ch">\n</span><span class="st">&quot;</span>, confusion_matrix_best)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Model Accuracy:  0.3464977645305514

Best Model Classification Report: 
               precision    recall  f1-score   support

    Abnormal       0.34      0.29      0.32       439
Inconclusive       0.38      0.23      0.29       456
      Normal       0.34      0.52      0.41       447

    accuracy                           0.35      1342
   macro avg       0.35      0.35      0.34      1342
weighted avg       0.35      0.35      0.34      1342


Best Model Confusion Matrix: 
 [[129  79 231]
 [124 104 228]
 [127  88 232]]
</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li><p>Conclusion:</p>
<blockquote>
<p><strong>The confusion matrix and the classification report together
indicate that the model is most frequently confusing 'Abnormal' with
'Normal', and overall, it is not performing well across all classes. In
order to have better results, we simply need more </strong>data** so
that we can be as accurate as possible.**</p>
</blockquote></li>
</ul>
</div>
</body>
</html>
